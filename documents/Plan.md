# План автоматизации тестирования веб-сервиса покупки путешествий через интернет-банк
## 1. Перечень автоматизируемых сценариев
## Тестирование UI
### Сценарии (Happy Path)
**1. Покупка тура на вкладке "Купить" с главной страницы сервиса**

<em>Cценарий 1.1: Оплата по валидной карте, на которой есть достаточное количество денежных средств. Операция одобрена.</em>

Шаги по воспроизведению:
1. Открыть главную страницу сервиса http://localhost:8080/
2. Нажать кнопку "Купить"
3. Заполнить все поля валидными данными карты с достаточным количеством средств на счете (например, Номер карты - 4444444444444441, Месяц - 09, Год - 22, Владелец - Ivanov Ivan, CVC/CVV - 123)
4. Нажать кнопку "Продолжить"
   <img width="825" alt="diploma1" src="https://user-images.githubusercontent.com/67234113/122552948-067cd880-d048-11eb-8376-c4363462f0bd.png">

*Ожидаемый результат: В правом верхнем углу появляется сообщение "Успешно Операция одобрена банком"*
<img width="960" alt="diploma3" src="https://user-images.githubusercontent.com/67234113/122553654-0204ef80-d049-11eb-8342-4fa39a366ba4.png">

<em>Cценарий 1.2: Отказ в покупке при оплате картой с валидным номером и недостаточным количеством средств на счете.</em>

Шаги по воспроизведению:

1. Открыть главную страницу сервиса http://localhost:8080/
2. Нажать кнопку "Купить"
3. Заполнить все поля валидными данными карты с недостаточным количеством средств на счете (например, Номер карты - 4444444444444442, Месяц - 09, Год - 22, Владелец - Ivanov Ivan, CVC/CVV - 123)
4. Нажать кнопку "Продолжить

*Ожидаемый результат: В правом верхнем углу появляется сообщение "Успешно Операция одобрена банком"*
<img width="955" alt="диплом 1 2" src="https://user-images.githubusercontent.com/67234113/126873667-58c07c0a-2c90-4d5e-9151-8cb9c9a29290.png">

**2. Покупка тура на вкладке "Купить в кредит" с главной страницы сервиса.**

<em>Cценарий 2.1: Успешная покупка в кредит при оплате картой с валидным номером и достаточным кредитным лимитом</em>

Шаги по воспроизведению:

1. Открыть главную страницу сервиса http://localhost:8080/
2. Нажать кнопку "Купить в кредит"
3. Заполнить все поля валидными данными карты с достаточным кредитным лимитом (например, Номер карты - 4444444444444441, Месяц - 09, Год - 22, Владелец - Ivanov Ivan, CVC/CVV - 123)
4. Нажать кнопку "Продолжить
   <img width="959" alt="диплом 2 1" src="https://user-images.githubusercontent.com/67234113/126873886-dec3381f-a749-4168-b6cc-03c91503bcdb.png">

*Ожидаемый результат: В правом верхнем углу появляется сообщение "Успешно Операция одобрена банком"*
<img width="960" alt="diploma3" src="https://user-images.githubusercontent.com/67234113/126873966-aa7c52ad-d9db-4544-9e25-2d9e9ff68dbc.png">

<em>Cценарий 2.1  Отказ в покупке в кредит при оплате картой с валидным номером и недостаточным кредитным лимитом</em>

Шаги по воспроизведению:

1. Открыть главную страницу сервиса http://localhost:8080/
2. Нажать кнопку "Купить в кредит"
3. Заполнить все поля валидными данными карты с недостаточным кредитным лимитом (например, Номер карты - 4444444444444442, Месяц - 09, Год - 22, Владелец - Ivanov Ivan, CVC/CVV - 123)
4. Нажать кнопку "Продолжить"

*Ожидаемый результат: В правом верхнем углу появляется сообщение "Ошибка! Банк отказал в проведении операции"*
<img width="955" alt="диплом 1 2" src="https://user-images.githubusercontent.com/67234113/126875722-4f6f0721-9661-4dfa-b12f-ed27e27bf32c.png">

------------

### Тестируем поля форм ввода данных

Каждый тестовый сценарий для тестирования формы ввода подразумевает стандартный путь захода на страницу формы (в зависимости от того, какую именно форму мы хотим протестировать):

Для формы "Оплата по карте": на главной странице сервиса нажимаем на кнопку "Купить";
Для формы "Кредит по данным карты": на главной странице сервиса нажимаем на кнопку "Купить в кредит";

Далее необходимо заполнить поля, нажать кнопку "Продолжить" и ожидать результат.

### Все поля - пустые
После выполнения предусловий оставить все поля незаполненными и нажать кнопку "Продолжить"

*Данный случай является невалидным для всех полей формы (в этом случае возникают ошибки "Поле обязательно для заполнения", "Неверный формат")*

### Поле "Номер карты"
Поле "Номер карты" присутствует в обеих формах: "Оплата по карте" и "Кредит по данным карты" и допускает для ввода только цифры и их количество - 16.

<em>Предусловия для формы "Купить":</em> 

1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Месяц" = "09", "Год" = "22", "Владелец" = "Ivanov Ivan", "CVV" = "123".

<em>Предусловия для формы "Купить в кредит":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Месяц" = "09", "Год" = "22", "Владелец" = "Ivanov Ivan", "CVV" = "123".

*Невалидные данные для поля "Номер карты" (в этом случае возникают ошибки в зависимости от данных - под полем возникает ошибка красным цветом "Неверный формат", "Поле обязательно для заполнения", всплывающее окно в правом верхнем углу "Ошибка! Банк отказал в проведении операции."):*
1. Пустое поле
2. Номер карты содержит количество цифр менее 16
3. Номер карты не содержится в базе данных банка, например "5469444444444441"

### Поле "Месяц"

Требования: данное поле принимает на вход номер месяца от 1 до 12, причем числам от 1 до 9 всегда предшествует 0, т.к. форма принимает только 2 числа.

<em>Предусловия для формы "Купить":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Владелец" = "Ivanov Ivan", "CVV" = "123".

<em>Предусловия для формы "Купить в кредит":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Владелец" = "Ivanov Ivan", "CVV" = "123".

*Невалидные данные для поля "Месяц" (в этом случае возникают ошибки в зависимости от данных - под полем возникает ошибка красным цветом "Неверный формат", "Поле обязательно для заполнения", "Неверно указан срок действия карты"):*
1. Пустое поле
2. Поле содержит одну цифру (например, 1)
3. Поле содержит двузначное число более 12 (например, 13)
4. Поле содержит нулевое значение (например, 00)

### Поле "Год"

Требования: данное поле принимает на вход номер года в формате двух последних цифр.

<em>Предусловия для формы "Купить":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Месяц" = "09", "Владелец" = "Ivanov Ivan", "CVV" = "123".

<em>Предусловия для формы "Купить в кредит":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Месяц" = "09", "Владелец" = "Ivanov Ivan", "CVV" = "123".

*Невалидные данные для поля "Год" (в этом случае возникают ошибки в зависимости от данных - под полем возникает ошибка красным цветом "Неверный формат", "Поле обязательно для заполнения", "Неверно указан срок действия карты", "Истёк срок действия карты"):*
1. Пустое поле
2. Поле содержит одну цифру (например, 1)
3. Поле содержит год ранее текущего (например, 20)
4. Поле содержит нулевое значение (например, 00)
5. Поле содержит год намного позднее текущего (например, 40)

### Поле "Владелец"

Требования: данное поле принимает на вход только фамилию и имя на латинском, первая буква в каждом из слов автоматически делается заглавной.

<em>Предусловия для формы "Купить":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Месяц" = "09", "CVV" = "123".

<em>Предусловия для формы "Купить в кредит":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Месяц" = "09", "CVV" = "123".

*Невалидные данные для поля "Владелец" (в этом случае возникают ошибки в зависимости от данных - под полем возникает ошибка красным цветом "Неверный формат", "Поле обязательно для заполнения"):*

1. Пустое поле
2. Поле содержит одно слово на английском языке (например, Ivanov)
3. Поле содержит три слова на английском языке (например, Ivanov Ivan Petrovich)
4. Заявка не должна отправляться, если поле "Владелец" содержит фамилию и имя в нижнем регистре (например, "ivanov ivan");
5. Заявка не должна отправляться, если поле "Владелец" содержит фамилию и имя в верхнем регистре (например, "IVANOV PETR");
6. Поле содержит русские буквы (например, Иванов Иван)
7. Поле содержит цифры (например, 5432 3232)
8. Поле содержит спецсимволы (например, #%№)

### Поле "CVC/CVV"

Требования: данное поле принимает на вход только 3 цифры.

<em>Предусловия для формы "Купить":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Месяц" = "09", "Владелец" = "Ivanov Ivan".

<em>Предусловия для формы "Купить в кредит":</em>

1. На главной странице сервиса нажимаем на кнопку "Купить в кредит";
2. Заполняем поля следующими валидными данными: "Номер" = "4444 4444 4444 4441", "Год" = "22", "Месяц" = "09", "Владелец" = "Ivanov Ivan".

*Невалидные данные для поля "CVC/CVV" (в этом случае возникают ошибки в зависимости от данных - под полем возникает ошибка красным цветом "Неверный формат", "Поле обязательно для заполнения"):*
1. Пустое поле
2. Поле содержит одну цифру (например, 1)
3. Поле содержит две цифры (например, 12)
4. Поле содержит три нуля (000)

## Тестирование API

Необходимо проверить через API банковские карты и их статусы в БД.

Данные для карты со статусом APPROVED: Номер карты - 4444444444444441, Месяц - 09, Год - 24, Владелец - Popov Igor, CVC/CVV - 123
Данные для карты со статусом DECLINED: Номер карты - 4444444444444442, Месяц - 09, Год - 24, Владелец - Popov Igor, CVC/CVV - 123

Перечень тестируемых сценариев:
1. При оплате по карте 4444444444444441 (обращение к http://localhost:8080/api/v1/pay) ответ сервера - код 200 OK, статус карты APPROVED
2. При оплате по карте 4444444444444442 (обращение к http://localhost:8080/api/v1/pay) ответ сервера - код 200 OK, статус карты DECLINED
3. При отправке заявки на кредит по карте 4444444444444441 (обращение к http://localhost:8080/api/v1/credit) ответ сервера - код 200 OK, статус карты APPROVED
4. При отправке заявки на кредит по карте 4444444444444442 (обращение к http://localhost:8080/api/v1/credit) ответ сервера - код 200 OK, статус карты DECLINED

## 2. Перечень используемых инструментов
1. Java 11 - универсальный язык, позволяющий работать на всех ОС и различном оборудовании за счет виртуальной машины, которая полностью контролирует безопасность и прерывает работу если что-то пошло не так (несанкционированный доступ и пр.)
2.  IntelliJ IDEA - среда разработки для различных языков, совместимая с различными инструментами и возможностью их комбинирования и настройки под конкретный случай.
3. Docker - для развертывания виртуальных контейнеров и запуске в них баз данных MySQL и PostgreSQL, а также сервисов банка на NodeJS
4. JUnit5 - тестовый фреймворк, совместимый с JVM, содержит необходимые аннотации и assert’ы
5. Gradle - система сборки проекта. По сравнению с Maven, в Gradle проще подключать зависимости, меньше кода, гибкость системы.
6. Faker - система генерации случайных данных для тестов. Позволяет создать различные данные автоматически с учетом местоположения, а не придумывать данные и напрямую писать их в код.
7. Lombok - плагин для создания аннотаций, заменяющих значительное количество однообразных конструкторов, getters/setters и пр.
8. Selenide - фреймворк для автоматизированного тестирования веб-приложений на основе Selenium WebDriver. Подключение веб-драйвера происходит автоматически, простое написание кода тестов
9. Allure Report - система репортинга. Простое подключение к тестам, возможность отслеживать данные на протяжении времени
10. Git - система контроля версий. Удобство, возможность одновременной параллельной разработки, есть интеграция с IntelliJ IDEA

## 3. Перечень и описание возможных рисков при автоматизации

1. Проблемы с запуском приложения, подключением БД;
2. Сложности к раздельным подключением тестов через БД MySQL и PostgreSQL;
3. Изменение структуры страницы (html, css) - недоступность css-селекторов для проверки;
4. Ложные срабатывания тестов из-за некорректно сгенерированных данных Faker'ом;
5. Исходя из перечисленных ранее пунктов, переоценка стоимости автоматизации и поддержания автотестов в сторону повышения.

## 4. Интервальная оценка с учётом рисков (в часах)
- Разработка плана тестирования - 8 часов;
- Подготовка необходимых инструментов, написание кода автотестов - 50-70 часов;
- Подготовка отчетной документации, баг-репортов - 12 часов;
- Запас в виде 24 часов на непредвиденные обстоятельства.

## 5. План сдачи работ
- Готовность автотестов - 8 рабочих дней после утверждения плана;
- Результат работы автотестов - документы по итогам тестирования (отчет по итогам тестирования + баг-репорты) - 3 рабочих дня ;
- Подготовка отчёта по автоматизации - 3 рабочих для после проведения всех работ.




